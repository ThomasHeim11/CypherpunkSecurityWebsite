name: ðŸ”§ Setup Check

on:
  workflow_dispatch:
  schedule:
    - cron: '0 9 * * 1' # Weekly on Monday

jobs:
  setup-check:
    name: ðŸ” Check CI/CD Setup
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ” Check Required Secrets
        run: |
          echo "# ðŸ”§ CI/CD Setup Status" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Secret | Status | Purpose |" >> $GITHUB_STEP_SUMMARY
          echo "|--------|--------|---------|" >> $GITHUB_STEP_SUMMARY

          # Check SNYK_TOKEN
          if [ -n "${{ secrets.SNYK_TOKEN }}" ]; then
            echo "| SNYK_TOKEN | âœ… Configured | Vulnerability scanning |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| SNYK_TOKEN | âŒ Missing | Vulnerability scanning |" >> $GITHUB_STEP_SUMMARY
          fi

          # Check CODECOV_TOKEN
          if [ -n "${{ secrets.CODECOV_TOKEN }}" ]; then
            echo "| CODECOV_TOKEN | âœ… Configured | Test coverage reports |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| CODECOV_TOKEN | âŒ Missing | Test coverage reports |" >> $GITHUB_STEP_SUMMARY
          fi



          # Check SEMGREP_APP_TOKEN
          if [ -n "${{ secrets.SEMGREP_APP_TOKEN }}" ]; then
            echo "| SEMGREP_APP_TOKEN | âœ… Configured | Advanced SAST scanning |" >> $GITHUB_STEP_SUMMARY
          else
            echo "| SEMGREP_APP_TOKEN | âŒ Missing | Advanced SAST scanning |" >> $GITHUB_STEP_SUMMARY
          fi

          echo "" >> $GITHUB_STEP_SUMMARY
          echo "## ðŸ“‹ Setup Instructions" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Required for Full Functionality:" >> $GITHUB_STEP_SUMMARY
          echo "1. **SNYK_TOKEN**: Get from https://snyk.io â†’ Account Settings â†’ API Token" >> $GITHUB_STEP_SUMMARY
          echo "2. **CODECOV_TOKEN**: Get from https://codecov.io â†’ Add Repository" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### Optional (Enhanced Features):" >> $GITHUB_STEP_SUMMARY
          echo "3. **SEMGREP_APP_TOKEN**: Get from https://semgrep.dev â†’ Settings" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Add secrets at:** Repository Settings â†’ Secrets and variables â†’ Actions" >> $GITHUB_STEP_SUMMARY

      - name: ðŸ“Š Environment Info
        run: |
          echo "## ðŸŒ Environment Information" >> $GITHUB_STEP_SUMMARY
          echo "- **Runner OS**: ${{ runner.os }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Repository**: ${{ github.repository }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Branch**: ${{ github.ref }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Event**: ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Node.js**: $(node --version)" >> $GITHUB_STEP_SUMMARY
          echo "- **NPM**: $(npm --version)" >> $GITHUB_STEP_SUMMARY
